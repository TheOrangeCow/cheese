<!--DOCTYPE html>
<html>
<head>
  <title>Shipping Info</title>
</head>
<body>
  <h2>Enter your shipping information</h2>

  <form id="shippingForm">
    <label>Name:</label><br>
    <input type="text" id="name" required><br><br>

    <label>Email or Phone:</label><br>
    <input type="text" id="contact" required><br><br>

    <label>Address:</label><br>
    <textarea id="address" required></textarea><br><br>

    <button type="submit">Submit</button>
  </form>

  <p id="result"></p>

  <script>
    // Change this to your deployed backend URL
    const backendURL = "https://cheese-backend2.onrender.com/save-info";

    document.getElementById("shippingForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = {
        name: document.getElementById("name").value,
        contact: document.getElementById("contact").value,
        address: document.getElementById("address").value
      };

      try {
        const res = await fetch(backendURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await res.json();
        document.getElementById("result").innerText =
          result.success ? "âœ… Info saved!" : " Error saving info.";
      } catch (err) {
        document.getElementById("result").innerText = " Connection error.";
      }
    });
  </script>
</body>
</html-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Personal Info Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f6f7;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    form {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      width: 340px;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    input {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
    }
    input:focus {
      border-color: #0078ff;
      outline: none;
    }
    small {
      color: red;
      display: none;
      font-size: 13px;
    }
    #suggestions {
      background: #fff;
      border: 1px solid #ccc;
      border-top: none;
      max-height: 150px;
      overflow-y: auto;
      border-radius: 0 0 5px 5px;
      position: absolute;
      width: calc(100% - 20px);
      z-index: 10;
    }
    #suggestions div {
      padding: 6px;
      cursor: pointer;
    }
    #suggestions div:hover {
      background: #f0f0f0;
    }
    button {
      width: 100%;
      padding: 10px;
      margin-top: 15px;
      background: #0078ff;
      border: none;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    .field {
      position: relative;
    }
  </style>
</head>
<body>
  <form id="infoForm">
    <label for="name">Name</label>
    <input type="text" id="name" placeholder="John Smith" />
    <small id="nameError">Name must be at least 2 characters.</small>

    <label for="contact">Email or Phone</label>
    <input type="text" id="contact" placeholder="email@example.com or 07123456789" />
    <small id="contactError">Please enter a valid email or phone number.</small>

    <label for="address">Address</label>
    <div class="field">
      <input type="text" id="address" placeholder="Start typing your address..." autocomplete="off" />
      <div id="suggestions"></div>
    </div>
    <small id="addressError">Please enter a valid address.</small>

    <button type="submit">Submit</button>
  </form>

  <script>
    const nameInput = document.getElementById("name");
    const contactInput = document.getElementById("contact");
    const addressInput = document.getElementById("address");
    const suggestionsBox = document.getElementById("suggestions");

    const nameError = document.getElementById("nameError");
    const contactError = document.getElementById("contactError");
    const addressError = document.getElementById("addressError");

    function validate(input) {
      if (input === nameInput) {
        nameError.style.display = nameInput.value.trim().length < 2 ? "block" : "none";
      }
      if (input === contactInput) {
        const val = contactInput.value.trim();
        const valid = /^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(val) || /^\d{10,}$/.test(val);
        contactError.style.display = valid ? "none" : "block";
      }
      if (input === addressInput) {
        addressError.style.display = addressInput.value.trim().length < 5 ? "block" : "none";
      }
    }

    nameInput.addEventListener("input", () => validate(nameInput));
    contactInput.addEventListener("input", () => validate(contactInput));

    // Address autocomplete using OpenStreetMap (Nominatim)
    let timeout;
    addressInput.addEventListener("input", () => {
      validate(addressInput);
      clearTimeout(timeout);
      const query = addressInput.value.trim();
      suggestionsBox.innerHTML = "";
      if (query.length < 3) return;

      timeout = setTimeout(async () => {
        const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&addressdetails=1&limit=5`;
        const response = await fetch(url, { headers: { "User-Agent": "MyAddressApp/1.0" } });
        const results = await response.json();
        if (!results.length) return;
        results.forEach((r) => {
          const div = document.createElement("div");
          div.textContent = r.display_name;
          div.addEventListener("click", () => {
            addressInput.value = r.display_name;
            suggestionsBox.innerHTML = "";
            validate(addressInput);
          });
          suggestionsBox.appendChild(div);
        });
      }, 400);
    });

    document.addEventListener("click", (e) => {
      if (!addressInput.contains(e.target)) suggestionsBox.innerHTML = "";
    });

    document.getElementById("infoForm").addEventListener("submit", (e) => {
      e.preventDefault();
      validate(nameInput);
      validate(contactInput);
      validate(addressInput);

      if (
        nameError.style.display === "none" &&
        contactError.style.display === "none" &&
        addressError.style.display === "none"
      ) {
        const userData = {
          name: nameInput.value,
          contact: contactInput.value,
          address: addressInput.value,
        };
        localStorage.setItem("userInfo", JSON.stringify(userData));
        alert("Information saved to local storage!");
      } else {
        alert("Please fix the errors before submitting.");
      }
    });
  </script>
</body>
</html>
