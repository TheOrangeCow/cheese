<!--DOCTYPE html>
<html>
<head>
  <title>Shipping Info</title>
</head>
<body>
  <h2>Enter your shipping information</h2>

  <form id="shippingForm">
    <label>Name:</label><br>
    <input type="text" id="name" required><br><br>

    <label>Email or Phone:</label><br>
    <input type="text" id="contact" required><br><br>

    <label>Address:</label><br>
    <textarea id="address" required></textarea><br><br>

    <button type="submit">Submit</button>
  </form>

  <p id="result"></p>

  <script>
    // Change this to your deployed backend URL
    const backendURL = "https://cheese-backend2.onrender.com/save-info";

    document.getElementById("shippingForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = {
        name: document.getElementById("name").value,
        contact: document.getElementById("contact").value,
        address: document.getElementById("address").value
      };

      try {
        const res = await fetch(backendURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await res.json();
        document.getElementById("result").innerText =
          result.success ? "✅ Info saved!" : " Error saving info.";
      } catch (err) {
        document.getElementById("result").innerText = " Connection error.";
      }
    });
  </script>
</body>
</html-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Person Info — Live Validation</title>
  <style>
    body{font-family:Inter, system-ui, sans-serif;background:#0f1724;color:#e6eef8;padding:32px}
    .wrap{max-width:600px;margin:auto}
    form{display:grid;gap:12px;background:#111a2d;padding:22px;border-radius:10px}
    label{font-size:14px;color:#94a3b8}
    input,textarea,select{width:100%;padding:10px;border-radius:6px;border:1px solid #2a3b55;background:#0b1320;color:inherit;font-size:15px}
    input:focus,textarea:focus{outline:none;border-color:#60a5fa}
    .error{font-size:12px;color:#ef4444;margin-top:4px;min-height:14px}
    button{background:#60a5fa;color:#0b1320;border:none;padding:10px;border-radius:6px;font-weight:600;cursor:pointer}
    button:hover{background:#7eb4ff}
    .success{color:#10b981;font-weight:600;margin-top:10px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Enter Your Information</h1>
    <form id="personForm" novalidate>
      <div>
        <label for="fullname">Full name</label>
        <input id="fullname" name="fullname" type="text" required placeholder="e.g. Alex Johnson" />
        <div class="error" id="nameError"></div>
      </div>
      <div>
        <label for="contactChoice">Preferred contact</label>
        <select id="contactChoice">
          <option value="email">Email</option>
          <option value="phone">Phone</option>
        </select>
      </div>
      <div id="emailWrap">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" placeholder="you@example.com" />
        <div class="error" id="emailError"></div>
      </div>
      <div id="phoneWrap" style="display:none">
        <label for="phone">Phone</label>
        <input id="phone" name="phone" type="tel" placeholder="+44 7123 456789" />
        <div class="error" id="phoneError"></div>
      </div>
      <div>
        <label for="address1">Address line 1</label>
        <input id="address1" name="address1" type="text" />
        <div class="error" id="addressError"></div>
      </div>
      <div>
        <label for="city">City / Town</label>
        <input id="city" name="city" type="text" />
        <div class="error" id="cityError"></div>
      </div>
      <div>
        <label for="postcode">Postcode / ZIP</label>
        <input id="postcode" name="postcode" type="text" />
        <div class="error" id="postcodeError"></div>
      </div>
      <button type="submit">Submit</button>
      <div id="status" class="success"></div>
    </form>
  </div>

  <script>
    const form = document.getElementById('personForm');
    const contactChoice = document.getElementById('contactChoice');
    const emailWrap = document.getElementById('emailWrap');
    const phoneWrap = document.getElementById('phoneWrap');

    const fields = {
      fullname: document.getElementById('fullname'),
      email: document.getElementById('email'),
      phone: document.getElementById('phone'),
      address1: document.getElementById('address1'),
      city: document.getElementById('city'),
      postcode: document.getElementById('postcode')
    };

    const errors = {
      fullname: document.getElementById('nameError'),
      email: document.getElementById('emailError'),
      phone: document.getElementById('phoneError'),
      address1: document.getElementById('addressError'),
      city: document.getElementById('cityError'),
      postcode: document.getElementById('postcodeError')
    };

    contactChoice.addEventListener('change', ()=>{
      if (contactChoice.value==='email'){
        emailWrap.style.display='';
        phoneWrap.style.display='none';
      } else {
        emailWrap.style.display='none';
        phoneWrap.style.display='';
      }
    });

    for (const key in fields){
      fields[key].addEventListener('input', ()=>validateField(key));
    }

    function validateField(name){
      const v = fields[name].value.trim();
      let message = '';
      switch(name){
        case 'fullname':
          if (v.length < 2) message = 'Name must be at least 2 characters.';
          break;
        case 'email':
          if (contactChoice.value==='email' && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v)) message = 'Enter a valid email.';
          break;
        case 'phone':
          if (contactChoice.value==='phone' && !/^\+?[0-9]{7,15}$/.test(v.replace(/[^0-9+]/g,''))) message = 'Enter a valid phone number.';
          break;
        case 'address1':
          if (!v) message = 'Address cannot be empty.';
          break;
        case 'city':
          if (!v) message = 'City cannot be empty.';
          break;
        case 'postcode':
          if (!/^[A-Za-z0-9 \-]{3,10}$/.test(v)) message = 'Invalid postcode format.';
          break;
      }
      errors[name].textContent = message;
      return message==="";
    }

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      let ok = true;
      for (const key in fields){ if (!validateField(key)) ok=false; }
      if (ok){
        localStorage.setItem('personInfo_v1', JSON.stringify(Object.fromEntries(new FormData(form))));
        document.getElementById('status').textContent = 'Saved successfully!';
      } else {
        document.getElementById('status').textContent = '';
      }
    });

    // Load saved
    window.addEventListener('load', ()=>{
      const data = localStorage.getItem('personInfo_v1');
      if (!data) return;
      const obj = JSON.parse(data);
      for (const key in fields){ if (obj[key]) fields[key].value=obj[key]; }
      contactChoice.dispatchEvent(new Event('change'));
    });
  </script>
</body>
</html>

