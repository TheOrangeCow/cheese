<!--DOCTYPE html>
<html>
<head>
  <title>Shipping Info</title>
</head>
<body>
  <h2>Enter your shipping information</h2>

  <form id="shippingForm">
    <label>Name:</label><br>
    <input type="text" id="name" required><br><br>

    <label>Email or Phone:</label><br>
    <input type="text" id="contact" required><br><br>

    <label>Address:</label><br>
    <textarea id="address" required></textarea><br><br>

    <button type="submit">Submit</button>
  </form>

  <p id="result"></p>

  <script>
    // Change this to your deployed backend URL
    const backendURL = "https://cheese-backend2.onrender.com/save-info";

    document.getElementById("shippingForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = {
        name: document.getElementById("name").value,
        contact: document.getElementById("contact").value,
        address: document.getElementById("address").value
      };

      try {
        const res = await fetch(backendURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await res.json();
        document.getElementById("result").innerText =
          result.success ? "✅ Info saved!" : " Error saving info.";
      } catch (err) {
        document.getElementById("result").innerText = " Connection error.";
      }
    });
  </script>
</body>
</html-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Person Info — Save to localStorage</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1320;--muted:#94a3b8;--accent:#60a5fa;--ok:#10b981;--err:#ef4444}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; background:linear-gradient(180deg,#071026 0%, #071728 100%); color:#e6eef8; padding:32px}
    .wrap{max-width:880px;margin:0 auto}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px;padding:22px;box-shadow:0 6px 30px rgba(2,6,23,0.6)}
    h1{margin:0 0 8px;font-size:20px}
    p.lead{color:var(--muted);margin:0 0 18px}
    form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input,select,textarea{width:100%;padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:inherit;font-size:14px}
    .full{grid-column:1/3}
    .row{display:flex;gap:8px}
    .help{font-size:12px;color:var(--muted);margin-top:6px}
    .hint{font-size:12px;color:var(--muted);display:flex;justify-content:space-between;align-items:center}
    .muted{color:var(--muted)}
    .actions{display:flex;gap:8px;margin-top:14px}
    button{padding:10px 12px;border-radius:8px;border:0;background:var(--accent);color:#05203a;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);font-weight:600}
    .ok{color:var(--ok);font-weight:700}
    .err{color:var(--err);font-weight:700}
    .field-valid{border-color:rgba(16,185,129,0.35);box-shadow:0 6px 18px rgba(16,185,129,0.06)}
    .field-invalid{border-color:rgba(239,68,68,0.35);box-shadow:0 6px 18px rgba(239,68,68,0.04)}
    .small{font-size:12px}
    .toolbar{display:flex;gap:8px;margin-bottom:12px}
    .status{margin-left:auto;font-size:13px;color:var(--muted)}
    .toggle{display:flex;gap:6px;align-items:center}
    .mini{padding:6px 8px;font-size:13px}
    .note{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;margin-top:12px}
    @media (max-width:760px){form{grid-template-columns:1fr} .full{grid-column:1/2}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="region" aria-label="Person info form">
      <div class="toolbar">
        <div>
          <h1>Save your info (localStorage)</h1>
          <p class="lead">Enter name, email or phone, and address. The form helps you fill it, validates input live, and saves to your browser.</p>
        </div>
        <div class="status" id="lastSaved">No saved data</div>
      </div>

      <form id="personForm" autocomplete="on" novalidate>
        <div class="full">
          <label for="fullname">Full name</label>
          <input id="fullname" name="fullname" type="text" placeholder="e.g. Alex Johnson" autocomplete="name" required />
          <div class="help small" id="nameHelp">Name should be at least 2 characters.</div>
        </div>

        <div>
          <label for="contactChoice">Preferred contact</label>
          <select id="contactChoice" name="contactChoice" aria-label="Choose contact method">
            <option value="email">Email</option>
            <option value="phone">Phone</option>
          </select>
        </div>

        <div id="emailWrap">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" placeholder="you@example.com" autocomplete="email" />
          <div class="help small" id="emailHelp">We'll check format automatically.</div>
        </div>

        <div id="phoneWrap" style="display:none">
          <label for="phone">Phone</label>
          <input id="phone" name="phone" inputmode="tel" type="tel" placeholder="+44 7123 456789" autocomplete="tel" />
          <div class="help small" id="phoneHelp">Include country code for best results.</div>
        </div>

        <div class="full">
          <label for="address1">Address line 1</label>
          <input id="address1" name="address1" type="text" autocomplete="street-address" placeholder="Street name and number" />
        </div>

        <div>
          <label for="address2">Address line 2</label>
          <input id="address2" name="address2" type="text" placeholder="Apartment or building (optional)" />
        </div>

        <div>
          <label for="city">City / Town</label>
          <input id="city" name="city" type="text" autocomplete="address-level2" />
        </div>

        <div>
          <label for="postcode">Postcode / ZIP</label>
          <input id="postcode" name="postcode" type="text" autocomplete="postal-code" />
        </div>

        <div>
          <label for="country">Country</label>
          <input id="country" name="country" type="text" autocomplete="country" placeholder="United Kingdom" />
        </div>

        <div class="full">
          <label for="notes">Notes (optional)</label>
          <textarea id="notes" name="notes" rows="3" placeholder="Anything else to remember..."></textarea>
        </div>

        <div class="actions full">
          <button type="button" id="saveBtn" class="mini">Save to localStorage</button>
          <button type="button" id="loadBtn" class="ghost mini">Load saved</button>
          <button type="button" id="clearBtn" class="ghost mini">Clear saved</button>
          <button type="button" id="prefillBtn" class="mini">Help me fill (sample)</button>
          <button type="button" id="validateBtn" class="ghost mini">Validate</button>
        </div>

        <div class="note full small" id="validationSummary" aria-live="polite">Validation results will appear here.</div>
      </form>

    </div>
  </div>

  <script>
    // Local storage key
    const STORAGE_KEY = 'personInfo_v1';

    // Elements
    const form = document.getElementById('personForm');
    const fullname = document.getElementById('fullname');
    const contactChoice = document.getElementById('contactChoice');
    const email = document.getElementById('email');
    const phone = document.getElementById('phone');
    const emailWrap = document.getElementById('emailWrap');
    const phoneWrap = document.getElementById('phoneWrap');
    const address1 = document.getElementById('address1');
    const address2 = document.getElementById('address2');
    const city = document.getElementById('city');
    const postcode = document.getElementById('postcode');
    const country = document.getElementById('country');
    const notes = document.getElementById('notes');
    const lastSaved = document.getElementById('lastSaved');
    const validationSummary = document.getElementById('validationSummary');

    // Buttons
    document.getElementById('saveBtn').addEventListener('click', saveData);
    document.getElementById('loadBtn').addEventListener('click', loadData);
    document.getElementById('clearBtn').addEventListener('click', clearSaved);
    document.getElementById('prefillBtn').addEventListener('click', prefillSample);
    document.getElementById('validateBtn').addEventListener('click', runValidation);

    // Switch between contact inputs
    contactChoice.addEventListener('change', () => {
      if (contactChoice.value === 'email'){
        emailWrap.style.display = '';
        phoneWrap.style.display = 'none';
      } else {
        emailWrap.style.display = 'none';
        phoneWrap.style.display = '';
      }
    });

    // Live validation handlers
    fullname.addEventListener('input', () => validateName());
    email.addEventListener('input', () => validateEmail());
    phone.addEventListener('input', () => validatePhone());
    postcode.addEventListener('input', () => validatePostcode());

    // Helpers: validators
    function validateName(){
      const v = fullname.value.trim();
      if (v.length >= 2) setValid(fullname, true);
      else setValid(fullname, false, 'Name too short');
      return v.length >= 2;
    }

    function validateEmail(){
      const v = email.value.trim();
      // basic RFC-like check (not exhaustive)
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (v === ''){ setNeutral(email); return false; }
      const ok = re.test(v);
      setValid(email, ok, ok ? '' : 'Invalid email format');
      return ok;
    }

    function validatePhone(){
      const v = phone.value.replace(/[^+0-9]/g,'').trim();
      // very basic check: +country + number (7-15 digits)
      const re = /^\+?[0-9]{7,15}$/;
      if (v === ''){ setNeutral(phone); return false; }
      const ok = re.test(v);
      setValid(phone, ok, ok ? '' : 'Phone must be digits, include country code');
      return ok;
    }

    function validatePostcode(){
      const v = postcode.value.trim();
      if (v === ''){ setNeutral(postcode); return false; }
      // allow alphanumeric 3-10 chars
      const ok = /^[A-Za-z0-9 \-]{3,10}$/.test(v);
      setValid(postcode, ok, ok ? '' : 'Check postcode/ZIP');
      return ok;
    }

    // UI state helpers
    function setValid(el, ok, message=''){
      el.classList.remove('field-invalid');
      if (ok){ el.classList.add('field-valid'); el.setAttribute('aria-invalid','false'); }
      else { el.classList.add('field-invalid'); el.setAttribute('aria-invalid','true'); }
      // attach message where present (simple)
      const help = el.nextElementSibling;
      if (help && help.classList.contains('help')){ help.textContent = message || 'Looks good'; }
    }
    function setNeutral(el){ el.classList.remove('field-valid','field-invalid'); el.removeAttribute('aria-invalid'); const help=el.nextElementSibling; if (help && help.classList.contains('help')) help.textContent = '' }

    // Save data to localStorage
    function saveData(){
      const data = collectForm();
      const validation = quickValidate(data);
      if (!validation.ok){
        validationSummary.textContent = 'Cannot save — please fix: ' + validation.errors.join(', ');
        validationSummary.classList.add('err');
        return;
      }
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      const now = new Date().toLocaleString();
      lastSaved.textContent = 'Saved ' + now;
      validationSummary.textContent = 'Saved successfully ✓';
      validationSummary.classList.remove('err');
    }

    // Load data from localStorage
    function loadData(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw){ validationSummary.textContent = 'No saved data found.'; return; }
      try{
        const data = JSON.parse(raw);
        fillForm(data);
        validationSummary.textContent = 'Loaded saved data.';
      }catch(e){ validationSummary.textContent = 'Failed to load saved data.'; }
    }

    // Clear saved
    function clearSaved(){ localStorage.removeItem(STORAGE_KEY); validationSummary.textContent='Cleared saved data.'; lastSaved.textContent='No saved data'; }

    // Prefill helper sample
    function prefillSample(){
      const sample = {
        fullname: 'Jamie Roberts',
        contactChoice: 'email',
        email: 'jamie.roberts@example.com',
        phone: '+447123456789',
        address1: '12 Example Street',
        address2: 'Flat 5',
        city: 'London',
        postcode: 'SW1A 1AA',
        country: 'United Kingdom',
        notes: 'Sample entry — replace with your real details.'
      };
      fillForm(sample);
      validationSummary.textContent = 'Prefilled sample data — edit as needed.';
    }

    // Collect data from form
    function collectForm(){
      return {
        fullname: fullname.value.trim(),
        contactChoice: contactChoice.value,
        email: email.value.trim(),
        phone: phone.value.trim(),
        address1: address1.value.trim(),
        address2: address2.value.trim(),
        city: city.value.trim(),
        postcode: postcode.value.trim(),
        country: country.value.trim(),
        notes: notes.value.trim()
      };
    }

    // Fill form from object
    function fillForm(data){
      fullname.value = data.fullname || '';
      contactChoice.value = data.contactChoice || 'email';
      email.value = data.email || '';
      phone.value = data.phone || '';
      address1.value = data.address1 || '';
      address2.value = data.address2 || '';
      city.value = data.city || '';
      postcode.value = data.postcode || '';
      country.value = data.country || '';
      notes.value = data.notes || '';
      // trigger contact toggle
      contactChoice.dispatchEvent(new Event('change'));
      // run validators
      validateName(); validateEmail(); validatePhone(); validatePostcode();
    }

    // Quick validation before saving
    function quickValidate(data){
      const errs = [];
      if (!data.fullname || data.fullname.length < 2) errs.push('name');
      if (data.contactChoice === 'email'){
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(data.email)) errs.push('email');
      } else {
        if (!/^\+?[0-9]{7,15}$/.test(data.phone.replace(/[^0-9+]/g,''))) errs.push('phone');
      }
      // At least one address field
      if (!data.address1 || !data.city) errs.push('address');
      return { ok: errs.length === 0, errors: errs };
    }

    function runValidation(){
      const data = collectForm();
      const res = quickValidate(data);
      if (res.ok){ validationSummary.textContent = 'All checks passed ✓'; validationSummary.classList.remove('err'); }
      else { validationSummary.textContent = 'Problems: ' + res.errors.join(', '); validationSummary.classList.add('err'); }
    }

    // Auto-load on start if there is saved data
    (function init(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if (raw){
        try{ const data = JSON.parse(raw); fillForm(data); lastSaved.textContent = 'Saved earlier'; }
        catch(e){ /* ignore */ }
      }
    })();

    // Accessibility: submit on enter does nothing (we save explicitly)
    form.addEventListener('submit', (e)=> e.preventDefault());

  </script>
</body>
</html>
